shadow$provide.module$node_modules$htmlparser$lib$htmlparser=function(global,require,module,exports){(function(){function Parser(handler,options){this._options=options?options:{};void 0==this._options.includeLocation&&(this._options.includeLocation=!1);this.validateHandler(handler);this._handler=handler;this.reset()}function RssHandler(callback){RssHandler.super_.call(this,callback,{ignoreWhitespace:!0,verbose:!1,enforceEmptyTags:!1})}function DefaultHandler(callback,options){this.reset();this._options=
options?options:{};void 0==this._options.ignoreWhitespace&&(this._options.ignoreWhitespace=!1);void 0==this._options.verbose&&(this._options.verbose=!0);void 0==this._options.enforceEmptyTags&&(this._options.enforceEmptyTags=!0);"function"==typeof callback&&(this._callback=callback)}if("function"!=typeof require||"object"!=typeof exports||"object"!=typeof module){if(!this.Tautologistics)this.Tautologistics={};else if(this.Tautologistics.NodeHtmlParser)return;this.Tautologistics.NodeHtmlParser={};
exports=this.Tautologistics.NodeHtmlParser}var ElementType={Text:"text",Directive:"directive",Comment:"comment",Script:"script",Style:"style",Tag:"tag"};Parser._reTrim=/(^\s+|\s+$)/g;Parser._reTrimComment=/(^!--|--$)/g;Parser._reWhitespace=/\s/g;Parser._reTagName=/^\s*(\/?)\s*([^\s\/]+)/;Parser._reAttrib=/([^=<>"'\s]+)\s*=\s*"([^"]*)"|([^=<>"'\s]+)\s*=\s*'([^']*)'|([^=<>"'\s]+)\s*=\s*([^'"\s]+)|([^=<>"'\s\/]+)/g;Parser._reTags=/[<>]/g;Parser.prototype.parseComplete=function(data){this.reset();this.parseChunk(data);
this.done()};Parser.prototype.parseChunk=function(data){this._done&&this.handleError(Error("Attempted to parse chunk after parsing already done"));this._buffer+=data;this.parseTags()};Parser.prototype.done=function(){if(!this._done){this._done=!0;if(this._buffer.length){var rawData=this._buffer;this._buffer="";rawData={raw:rawData,data:this._parseState==ElementType.Text?rawData:rawData.replace(Parser._reTrim,""),type:this._parseState};if(this._parseState==ElementType.Tag||this._parseState==ElementType.Script||
this._parseState==ElementType.Style)rawData.name=this.parseTagName(rawData.data);this.parseAttribs(rawData);this._elements.push(rawData)}this.writeHandler();this._handler.done()}};Parser.prototype.reset=function(){this._buffer="";this._done=!1;this._elements=[];this._next=this._current=this._elementsCurrent=0;this._location={row:0,col:0,charOffset:0,inBuffer:0};this._parseState=ElementType.Text;this._prevTagSep="";this._tagStack=[];this._handler.reset()};Parser.prototype._options=null;Parser.prototype._handler=
null;Parser.prototype._buffer=null;Parser.prototype._done=!1;Parser.prototype._elements=null;Parser.prototype._elementsCurrent=0;Parser.prototype._current=0;Parser.prototype._next=0;Parser.prototype._location=null;Parser.prototype._parseState=ElementType.Text;Parser.prototype._prevTagSep="";Parser.prototype._tagStack=null;Parser.prototype.parseTagAttribs=function(elements){for(var idxEnd=elements.length,idx=0;idx<idxEnd;){var element=elements[idx++];element.type!=ElementType.Tag&&element.type!=ElementType.Script&&
element.type!=ElementType.style||this.parseAttribs(element)}return elements};Parser.prototype.parseAttribs=function(element){if(element.type==ElementType.Script||element.type==ElementType.Style||element.type==ElementType.Tag){var tagName=element.data.split(Parser._reWhitespace,1)[0];tagName=element.data.substring(tagName.length);if(!(1>tagName.length)){var match;for(Parser._reAttrib.lastIndex=0;match=Parser._reAttrib.exec(tagName);)void 0==element.attribs&&(element.attribs={}),"string"==typeof match[1]&&
match[1].length?element.attribs[match[1]]=match[2]:"string"==typeof match[3]&&match[3].length?element.attribs[match[3].toString()]=match[4].toString():"string"==typeof match[5]&&match[5].length?element.attribs[match[5]]=match[6]:"string"==typeof match[7]&&match[7].length&&(element.attribs[match[7]]=match[7])}}};Parser.prototype.parseTagName=function(data){return null==data||""==data?"":(data=Parser._reTagName.exec(data))?(data[1]?"/":"")+data[2]:""};Parser.prototype.parseTags=function(){for(var bufferEnd=
this._buffer.length-1;Parser._reTags.test(this._buffer);){this._next=Parser._reTags.lastIndex-1;var tagSep=this._buffer.charAt(this._next),rawData=this._buffer.substring(this._current,this._next);rawData={raw:rawData,data:this._parseState==ElementType.Text?rawData:rawData.replace(Parser._reTrim,""),type:this._parseState};var elementName=this.parseTagName(rawData.data);if(this._tagStack.length)if(this._tagStack[this._tagStack.length-1]==ElementType.Script)if("/script"==elementName.toLowerCase())this._tagStack.pop();
else{if(0!=rawData.raw.indexOf("!--")&&(rawData.type=ElementType.Text,this._elements.length&&this._elements[this._elements.length-1].type==ElementType.Text)){var prevElement=this._elements[this._elements.length-1];prevElement.raw=prevElement.data=prevElement.raw+this._prevTagSep+rawData.raw;rawData.raw=rawData.data=""}}else this._tagStack[this._tagStack.length-1]==ElementType.Style?"/style"==elementName.toLowerCase()?this._tagStack.pop():0!=rawData.raw.indexOf("!--")&&(rawData.type=ElementType.Text,
this._elements.length&&this._elements[this._elements.length-1].type==ElementType.Text?(prevElement=this._elements[this._elements.length-1],""!=rawData.raw?(prevElement.raw=prevElement.data=prevElement.raw+this._prevTagSep+rawData.raw,rawData.raw=rawData.data=""):prevElement.raw=prevElement.data=prevElement.raw+this._prevTagSep):""!=rawData.raw&&(rawData.raw=rawData.data=rawData.raw)):this._tagStack[this._tagStack.length-1]==ElementType.Comment&&(prevElement=rawData.raw.length,"-"==rawData.raw.charAt(prevElement-
2)&&"-"==rawData.raw.charAt(prevElement-1)&&"\x3e"==tagSep?(this._tagStack.pop(),this._elements.length&&this._elements[this._elements.length-1].type==ElementType.Comment?(prevElement=this._elements[this._elements.length-1],prevElement.raw=prevElement.data=(prevElement.raw+rawData.raw).replace(Parser._reTrimComment,""),rawData.raw=rawData.data="",rawData.type=ElementType.Text):rawData.type=ElementType.Comment):(rawData.type=ElementType.Comment,this._elements.length&&this._elements[this._elements.length-
1].type==ElementType.Comment?(prevElement=this._elements[this._elements.length-1],prevElement.raw=prevElement.data=prevElement.raw+rawData.raw+tagSep,rawData.raw=rawData.data="",rawData.type=ElementType.Text):rawData.raw=rawData.data=rawData.raw+tagSep));rawData.type==ElementType.Tag&&(rawData.name=elementName,elementName=elementName.toLowerCase(),0==rawData.raw.indexOf("!--")?(rawData.type=ElementType.Comment,delete rawData.name,prevElement=rawData.raw.length,"-"==rawData.raw.charAt(prevElement-
1)&&"-"==rawData.raw.charAt(prevElement-2)&&"\x3e"==tagSep?rawData.raw=rawData.data=rawData.raw.replace(Parser._reTrimComment,""):(rawData.raw+=tagSep,this._tagStack.push(ElementType.Comment))):0==rawData.raw.indexOf("!")||0==rawData.raw.indexOf("?")?rawData.type=ElementType.Directive:"script"==elementName?(rawData.type=ElementType.Script,"/"!=rawData.data.charAt(rawData.data.length-1)&&this._tagStack.push(ElementType.Script)):"/script"==elementName?rawData.type=ElementType.Script:"style"==elementName?
(rawData.type=ElementType.Style,"/"!=rawData.data.charAt(rawData.data.length-1)&&this._tagStack.push(ElementType.Style)):"/style"==elementName&&(rawData.type=ElementType.Style),rawData.name&&"/"==rawData.name.charAt(0)&&(rawData.data=rawData.name));if(""!=rawData.raw||rawData.type!=ElementType.Text)this._options.includeLocation&&!rawData.location&&(rawData.location=this.getLocation(rawData.type==ElementType.Tag)),this.parseAttribs(rawData),this._elements.push(rawData),rawData.type!=ElementType.Text&&
rawData.type!=ElementType.Comment&&rawData.type!=ElementType.Directive&&"/"==rawData.data.charAt(rawData.data.length-1)&&this._elements.push({raw:"/"+rawData.name,data:"/"+rawData.name,name:"/"+rawData.name,type:rawData.type});this._parseState="\x3c"==tagSep?ElementType.Tag:ElementType.Text;this._current=this._next+1;this._prevTagSep=tagSep}this._options.includeLocation&&(this.getLocation(),this._location.row+=this._location.inBuffer,this._location.inBuffer=0,this._location.charOffset=0);this._buffer=
this._current<=bufferEnd?this._buffer.substring(this._current):"";this._current=0;this.writeHandler()};Parser.prototype.getLocation=function(startTag){for(var l=this._location,end=this._current-(startTag?1:0),chunk=startTag&&0==l.charOffset&&0==this._current;l.charOffset<end;l.charOffset++)startTag=this._buffer.charAt(l.charOffset),"\n"==startTag?(l.inBuffer++,l.col=0):"\r"!=startTag&&l.col++;return{line:l.row+l.inBuffer+1,col:l.col+(chunk?0:1)}};Parser.prototype.validateHandler=function(handler){if("object"!=
typeof handler)throw Error("Handler is not an object");if("function"!=typeof handler.reset)throw Error("Handler method 'reset' is invalid");if("function"!=typeof handler.done)throw Error("Handler method 'done' is invalid");if("function"!=typeof handler.writeTag)throw Error("Handler method 'writeTag' is invalid");if("function"!=typeof handler.writeText)throw Error("Handler method 'writeText' is invalid");if("function"!=typeof handler.writeComment)throw Error("Handler method 'writeComment' is invalid");
if("function"!=typeof handler.writeDirective)throw Error("Handler method 'writeDirective' is invalid");};Parser.prototype.writeHandler=function(forceFlush){if(!this._tagStack.length||forceFlush)for(;this._elements.length;)switch(forceFlush=this._elements.shift(),forceFlush.type){case ElementType.Comment:this._handler.writeComment(forceFlush);break;case ElementType.Directive:this._handler.writeDirective(forceFlush);break;case ElementType.Text:this._handler.writeText(forceFlush);break;default:this._handler.writeTag(forceFlush)}};
Parser.prototype.handleError=function(error){if("function"==typeof this._handler.error)this._handler.error(error);else throw error;};(function(ctor,superCtor){var tempCtor=function(){};tempCtor.prototype=superCtor.prototype;ctor.super_=superCtor;ctor.prototype=new tempCtor;ctor.prototype.constructor=ctor})(RssHandler,DefaultHandler);RssHandler.prototype.done=function(){var feed={},feedRoot,found=DomUtils.getElementsByTagName(function(value){return"rss"==value||"feed"==value},this.dom,!1);found.length&&
(feedRoot=found[0]);if(feedRoot){if("rss"==feedRoot.name){feed.type="rss";feedRoot=feedRoot.children[0];feed.id="";try{feed.title=DomUtils.getElementsByTagName("title",feedRoot.children,!1)[0].children[0].data}catch(ex){}try{feed.link=DomUtils.getElementsByTagName("link",feedRoot.children,!1)[0].children[0].data}catch(ex){}try{feed.description=DomUtils.getElementsByTagName("description",feedRoot.children,!1)[0].children[0].data}catch(ex){}try{feed.updated=new Date(DomUtils.getElementsByTagName("lastBuildDate",
feedRoot.children,!1)[0].children[0].data)}catch(ex){}try{feed.author=DomUtils.getElementsByTagName("managingEditor",feedRoot.children,!1)[0].children[0].data}catch(ex){}feed.items=[];DomUtils.getElementsByTagName("item",feedRoot.children).forEach(function(item,index,list){index={};try{index.id=DomUtils.getElementsByTagName("guid",item.children,!1)[0].children[0].data}catch(ex){}try{index.title=DomUtils.getElementsByTagName("title",item.children,!1)[0].children[0].data}catch(ex){}try{index.link=DomUtils.getElementsByTagName("link",
item.children,!1)[0].children[0].data}catch(ex){}try{index.description=DomUtils.getElementsByTagName("description",item.children,!1)[0].children[0].data}catch(ex){}try{index.pubDate=new Date(DomUtils.getElementsByTagName("pubDate",item.children,!1)[0].children[0].data)}catch(ex){}feed.items.push(index)})}else{feed.type="atom";try{feed.id=DomUtils.getElementsByTagName("id",feedRoot.children,!1)[0].children[0].data}catch(ex){}try{feed.title=DomUtils.getElementsByTagName("title",feedRoot.children,!1)[0].children[0].data}catch(ex){}try{feed.link=
DomUtils.getElementsByTagName("link",feedRoot.children,!1)[0].attribs.href}catch(ex){}try{feed.description=DomUtils.getElementsByTagName("subtitle",feedRoot.children,!1)[0].children[0].data}catch(ex){}try{feed.updated=new Date(DomUtils.getElementsByTagName("updated",feedRoot.children,!1)[0].children[0].data)}catch(ex){}try{feed.author=DomUtils.getElementsByTagName("email",feedRoot.children,!0)[0].children[0].data}catch(ex){}feed.items=[];DomUtils.getElementsByTagName("entry",feedRoot.children).forEach(function(item,
index,list){index={};try{index.id=DomUtils.getElementsByTagName("id",item.children,!1)[0].children[0].data}catch(ex){}try{index.title=DomUtils.getElementsByTagName("title",item.children,!1)[0].children[0].data}catch(ex){}try{index.link=DomUtils.getElementsByTagName("link",item.children,!1)[0].attribs.href}catch(ex){}try{index.description=DomUtils.getElementsByTagName("summary",item.children,!1)[0].children[0].data}catch(ex){}try{index.pubDate=new Date(DomUtils.getElementsByTagName("updated",item.children,
!1)[0].children[0].data)}catch(ex){}feed.items.push(index)})}this.dom=feed}RssHandler.super_.prototype.done.call(this)};DefaultHandler._emptyTags={area:1,base:1,basefont:1,br:1,col:1,frame:1,hr:1,img:1,input:1,isindex:1,link:1,meta:1,param:1,embed:1};DefaultHandler.reWhitespace=/^\s*$/;DefaultHandler.prototype.dom=null;DefaultHandler.prototype.reset=function(){this.dom=[];this._done=!1;this._tagStack=[];this._tagStack.last=function(){return this.length?this[this.length-1]:null}};DefaultHandler.prototype.done=
function(){this._done=!0;this.handleCallback(null)};DefaultHandler.prototype.writeTag=function(element){this.handleElement(element)};DefaultHandler.prototype.writeText=function(element){this._options.ignoreWhitespace&&DefaultHandler.reWhitespace.test(element.data)||this.handleElement(element)};DefaultHandler.prototype.writeComment=function(element){this.handleElement(element)};DefaultHandler.prototype.writeDirective=function(element){this.handleElement(element)};DefaultHandler.prototype.error=function(error){this.handleCallback(error)};
DefaultHandler.prototype._options=null;DefaultHandler.prototype._callback=null;DefaultHandler.prototype._done=!1;DefaultHandler.prototype._tagStack=null;DefaultHandler.prototype.handleCallback=function(error){if("function"!=typeof this._callback){if(error)throw error;}else this._callback(error,this.dom)};DefaultHandler.prototype.isEmptyTag=function(element){element=element.name.toLowerCase();"/"==element.charAt(0)&&(element=element.substring(1));return this._options.enforceEmptyTags&&!!DefaultHandler._emptyTags[element]};
DefaultHandler.prototype.handleElement=function(element){this._done&&this.handleCallback(Error("Writing to the handler after done() called is not allowed without a reset()"));this._options.verbose||(delete element.raw,"tag"!=element.type&&"script"!=element.type&&"style"!=element.type||delete element.data);if(this._tagStack.last())if(element.type!=ElementType.Text&&element.type!=ElementType.Comment&&element.type!=ElementType.Directive)if("/"==element.name.charAt(0)){var baseName=element.name.substring(1);
if(!this.isEmptyTag(element)){for(element=this._tagStack.length-1;-1<element&&this._tagStack[element--].name!=baseName;);if(-1<element||this._tagStack[0].name==baseName)for(;element<this._tagStack.length-1;)this._tagStack.pop()}}else this._tagStack.last().children||(this._tagStack.last().children=[]),this._tagStack.last().children.push(element),this.isEmptyTag(element)||this._tagStack.push(element);else this._tagStack.last().children||(this._tagStack.last().children=[]),this._tagStack.last().children.push(element);
else element.type!=ElementType.Text&&element.type!=ElementType.Comment&&element.type!=ElementType.Directive?"/"!=element.name.charAt(0)&&(this.dom.push(element),this.isEmptyTag(element)||this._tagStack.push(element)):this.dom.push(element)};var DomUtils={testElement:function(options,element){if(!element)return!1;for(var key in options)if("tag_name"==key){if("tag"!=element.type&&"script"!=element.type&&"style"!=element.type||!options.tag_name(element.name))return!1}else if("tag_type"==key){if(!options.tag_type(element.type))return!1}else if("tag_contains"==
key){if("text"!=element.type&&"comment"!=element.type&&"directive"!=element.type||!options.tag_contains(element.data))return!1}else if(!element.attribs||!options[key](element.attribs[key]))return!1;return!0},getElements:function(options,currentElement,recurse,limit){function getTest(checkVal){return function(value){return value==checkVal}}recurse=void 0===recurse||null===recurse||!!recurse;limit=isNaN(parseInt(limit))?-1:parseInt(limit);if(!currentElement)return[];var found=[],key;for(key in options)"function"!=
typeof options[key]&&(options[key]=getTest(options[key]));DomUtils.testElement(options,currentElement)&&found.push(currentElement);if(0<=limit&&found.length>=limit)return found;if(recurse&&currentElement.children)currentElement=currentElement.children;else if(!(currentElement instanceof Array))return found;for(key=0;key<currentElement.length&&!(found=found.concat(DomUtils.getElements(options,currentElement[key],recurse,limit)),0<=limit&&found.length>=limit);key++);return found},getElementById:function(id,
currentElement,recurse){id=DomUtils.getElements({id},currentElement,recurse,1);return id.length?id[0]:null},getElementsByTagName:function(name,currentElement,recurse,limit){return DomUtils.getElements({tag_name:name},currentElement,recurse,limit)},getElementsByTagType:function(type,currentElement,recurse,limit){return DomUtils.getElements({tag_type:type},currentElement,recurse,limit)}};exports.Parser=Parser;exports.DefaultHandler=DefaultHandler;exports.RssHandler=RssHandler;exports.ElementType=ElementType;
exports.DomUtils=DomUtils})()}
//# sourceMappingURL=module$node_modules$htmlparser$lib$htmlparser.js.map
